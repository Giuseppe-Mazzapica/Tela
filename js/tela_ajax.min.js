var TelaAjax={};(function(e,b,c,a,d){a.Ajax={isValidAjaxResponse:function(f){return typeof f==="object"&&typeof f.readyState==="number"&&f.readyState>0},getAjaxSettings:function(h,g,i){if(typeof h!=="string"||h===""){return false}if(i===null||typeof i!=="object"){i={}}if(g===null||typeof g!=="object"){g={}}if(typeof i.data==="object"){g=e.extend(i.data,g)}if(typeof c.nonces[h]==="undefined"){c.nonces[h]=""}var f={telaajax_is_admin:b.is_admin,telaajax_action:h,telaajax_nonce:c.nonces[h],telaajax_data:g};return e.extend(i,{url:b.url,data:f,type:"POST"})},run:function(g,f,h){return e.ajax(a.Ajax.getAjaxSettings(g,f,h))},updateHtml:function(g,h){g=e.extend({target:null,action:null,data:null,settings:null},g);var f=e(g.target);if(f.length<1){return false}if(!this.isValidAjaxResponse(h)){if(g.settings===null||typeof g.settings!=="object"){g.settings={}}g.settings.dataType="html";h=this.run(g.action,g.data,g.settings)}h.done(function(i){f.html(i)});return h},updateDataMap:function(g,h){var i={target:{},action:"",data:{},settings:{},html:true,parseCb:null};g=e.extend(i,g);var f=e(g.target);if(f.length<1||f.find("[data-tela-map]").length<1){return false}if(!this.isValidAjaxResponse(h)){if(g.settings===null||typeof g.settings!=="object"){g.settings={}}g.settings.dataType="json";h=this.run(g.action,g.data,g.settings)}h.done(function(j){a.Ajax.parseDataMap.apply(g.target,[j,g])});return h},parseDataMap:function(h,f){var g={target:{},data:{},html:true,parseCb:null};f=e.extend(g,f);var i=e(f.target);if(i.length<1||i.find("[data-tela-map]").length<1){return false}if(e.isFunction(f.parseCb)){h=f.parseCb.apply(f.target,[h,f.target,f.data])}e.each(h,function(l,k){if(typeof k==="string"){var j=i.find('[data-tela-map="'+l+'"]');if(j.length&&f.html){j.html(k)}else{if(j.length&&!f.html){j.text(k)}}}})},jsonEvent:function(f,j,i,g,h){if(typeof f!=="string"||f===""){return false}if(!this.isValidAjaxResponse(h)){if(g===null||typeof g!=="object"){g={}}g.dataType="json";h=this.run(j,i,g)}h.done(function(k){e(d).trigger(f,k)});return h}};a.PluginHelpers={ensureDataAttrType:function(g,f){if(typeof f!=="string"){f="string"}if(f==="object"&&g===null){g=""}if(typeof g===f){return g}if(typeof g==="string"&&g!==""){switch(f){case"boolean":if(g==="false"||g==="0"){return false}else{if(g==="true"||g==="1"){return true}}case"number":return Number(g);case"object":try{return JSON.parse(g)}catch(h){return null}}}return null},getSettingByData:function(h,g,k,i){if(typeof k!=="string"){k="string"}var f=(typeof i==="string"&&e(i).length>0)?e(i):this;if(k==="func"){if(e.isFunction(h)||e.isFunction(d[h])){return e.isFunction(h)?h:d[h]}else{var j=f.data("tela-"+g);if(e.isFunction(d[j])){return d[j]}}return null}else{if(typeof g==="string"){if(typeof h!==k||(k==="object"&&h===null)){var j=f.data("tela-"+g);return a.PluginHelpers.ensureDataAttrType(j,k)}}}return typeof h==="undefined"?null:h},init:function(f){var g={action:null,data:{},ajax:{},html:true,parseCb:null,event:null,updateOn:null,subject:null,done:null,fail:null,always:null};f=e.extend(g,f);f.action=a.PluginHelpers.getSettingByData.apply(this,[f.action,"action"]);f.event=a.PluginHelpers.getSettingByData.apply(this,[f.event,"event"]);if(!f.action||!f.event){return false}f.subject=a.PluginHelpers.getSettingByData.apply(this,[f.subject,"subject"]);if(typeof f.subject==="string"&&f.subject!==""){f.updateOn="subject-event"}else{f.updateOn=a.PluginHelpers.getSettingByData.apply(this,[f.updateOn,"update-on"])}f.html=a.PluginHelpers.getSettingByData.apply(this,[f.html,"map-html","boolean"]);f.parseCb=a.PluginHelpers.getSettingByData.apply(this,[f.parseCb,"map-callback","func"]);return f},getPostData:function(f){f=e.extend({source:null,context:null,options:null},f);var g={};if(e.isFunction(f.source)){if(typeof f.context!=="object"){f.context=this}if(typeof f.options==="undefined"){f.options={}}g=f.source.apply(f.context,[f.options])}else{if(typeof f.source==="object"){g=f.source}}return g},getSelector:function(){var f=e(this).data("tela-selector");if(typeof f!=="string"||f===""){var g=e(this).attr("id");if(typeof g==="string"&&g!==""){f="#"+g}}return(typeof f!=="string"||f==="")?false:f},response:function(f,g){if(!a.Ajax.isValidAjaxResponse(f)){return false}if(e.isFunction(g.done)){f.done(g.done)}if(e.isFunction(g.fail)){f.fail(g.fail)}if(e.isFunction(g.always)){f.always(g.always)}return f},runCallerUpdate:function(i,k,j,f){if(typeof f!=="object"){f={}}j=e.extend({action:null,ajax:null,html:null,parseCb:null},j);var h={target:k,action:j.action,data:a.PluginHelpers.getPostData.apply(i,[f]),settings:j.ajax,html:j.html,parseCb:j.parseCb};var g={};if(typeof i.data("tela-bind-map")!=="undefined"){g=a.Ajax.updateDataMap.apply(a.Ajax,[h])}else{g=a.Ajax.updateHtml.apply(a.Ajax,[h])}return a.PluginHelpers.response(g,h.settings)},runCallerAction:function(i,k){k=e.extend({action:null,ajax:null,data:null},k);var h={source:k.data,context:i};var j=a.PluginHelpers.getPostData.apply(i,[h]);var f=[k.action,j,k.ajax];var g=a.Ajax.run.apply(a.Ajax,f);return a.PluginHelpers.response(g,k)}};a.PluginMethods={subjectEvent:function(g){var f=this;if(typeof g.subject==="string"&&g.subject!==""){var h=this;e(document).on(g.event,g.subject,function(){var i={source:g.data,context:this};var j=[f,h,g,i];return a.PluginHelpers.runCallerUpdate.apply(this,j)})}},globalEvent:function(g){var f=this;var h=g.updateOn==="global-event"?e(d):e(document);h.on(g.event,function(){var i={source:g.data,context:f,options:arguments};var j=[f,f,g,i];return a.PluginHelpers.runCallerUpdate.apply(this,j)})},selfEvent:function(g){var f=this;e(this).on(g.event,function(){var h={source:g.data,context:f};var i=[f,f,g,h];return a.PluginHelpers.runCallerUpdate.apply(this,i)})},runAction:function(h){var g=this;var f=a.PluginHelpers.getSelector.apply(g);if(typeof f==="string"&&f!==""){e(document).on(h.event,f,function(){return a.PluginHelpers.runCallerAction.apply(this,[g,h])})}else{e(g).on(h.event,function(){return a.PluginHelpers.runCallerAction.apply(this,[g,h])})}}};e.fn.telaAjax=function(f){f=a.PluginHelpers.init.apply(this,[f]);if(typeof f==="object"&&typeof f.updateOn!=="undefined"){switch(f.updateOn){case"subject-event":return a.PluginMethods.subjectEvent.apply(this,[f]);case"global-event":case"document-event":return a.PluginMethods.globalEvent.apply(this,[f]);case"self-event":return a.PluginMethods.selfEvent.apply(this,[f]);default:return a.PluginMethods.runAction.apply(this,[f])}}return this}})(jQuery,TelaAjaxData,TelaAjaxNonces,TelaAjax,window);